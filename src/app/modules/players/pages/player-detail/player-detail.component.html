<div class="pt-14 min-h-screen bg-gradient-subtle">
  <main class="md:container mx-auto px-4 lg:px-8 py-8">
    <!-- Player Header -->
    @if (player.data(); as player) {
    <div class="bg-card border border-border rounded-lg shadow-card p-6 mb-8 relative">
      <div class="flex flex-col md:flex-row gap-6 items-start md:items-center">
        <img
          [src]="player.id | avatar"
          [alt]="player.name"
          class="w-32 h-32 rounded-lg object-cover border-2 border-border"
        />

        <div class="flex flex-col gap-2">
          <h1 class="text-4xl font-bold text-foreground">
            {{ player.name }} {{ player.last_name }}
          </h1>
          <div class="flex items-center gap-3 mb-3">
            <span
              class="px-3 py-1 rounded-full text-xs font-semibold border bg-primary/20 text-primary border-primary/30"
            >
              {{ player.position.toUpperCase() }}
            </span>
            @if (player.active) {
            <span
              class="px-3 py-1 rounded-full text-sm font-semibold bg-primary/20 text-primary border border-primary/30"
              >Active</span
            >
            } @else {
            <span
              class="px-3 py-1 rounded-full text-sm font-semibold bg-muted text-muted-foreground border border-border"
              >Inactive</span
            >
            }
          </div>
          <span class="text-5xl font-bold text-primary items-center"> # {{ player.number }} </span>
          <div appAuth class="flex gap-6 md:absolute md:bottom-6 md:right-6">
            <app-button
              type="button"
              (click)="this.isOpen.set(true)"
              [disabled]="!player.active"
              variant="neutral"
              >Edit player</app-button
            >
            @if (player.active){
            <app-button type="button" (click)="handleDeactivatePlayer()" variant="destructive"
              >Deactivate Player</app-button
            >
            } @else {
            <app-button type="button" (click)="handleActivatePlayer()" variant="primary"
              >Activate Player</app-button
            >
            }
          </div>
        </div>
      </div>
    </div>
    } @else if (player.isLoading()) {
    <div
      class="w-full h-[178px] bg-card border border-border rounded-lg shadow-card p-6 mb-8 animate-pulse"
    ></div>
    } @else if (player.isError()) {
    <p class="text-xl text-white font-semibold">{{ player.error() }}</p>
    }

    <!-- Stats Overview -->
    @if (stats.data(); as stats) {
    <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
      <!-- Partidos Jugados -->
      <div
        class="p-8 bg-card border border-border rounded-lg shadow-card hover:shadow-elevated transition-all"
      >
        <div class="flex items-center gap-3 mb-3">
          <svg
            xmlns="http://www.w3.org/2000/svg"
            class="w-6 h-6 text-primary"
            fill="none"
            viewBox="0 0 24 24"
            stroke="currentColor"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M5 3v4M3 5h4M6 17v4m-2-2h4m5-16l2.286 6.857L21 12l-5.714 2.143L13 21l-2.286-6.857L5 12l5.714-2.143L13 3z"
            />
          </svg>
          <p class="text-sm text-muted-foreground uppercase tracking-wide">Games played</p>
        </div>
        <p class="text-5xl font-bold text-foreground">{{ stats.total_games || 0 }}</p>
      </div>

      <!-- Puntos Totales -->
      <div
        class="p-8 bg-card border border-border rounded-lg shadow-card hover:shadow-elevated transition-all"
      >
        <div class="flex items-center gap-3 mb-3">
          <svg
            xmlns="http://www.w3.org/2000/svg"
            class="w-6 h-6 text-accent"
            fill="none"
            viewBox="0 0 24 24"
            stroke="currentColor"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M5 3v4M3 5h4M6 17v4m-2-2h4m5-16l2.286 6.857L21 12l-5.714 2.143L13 21l-2.286-6.857L5 12l5.714-2.143L13 3z"
            />
          </svg>
          <p class="text-sm text-muted-foreground uppercase tracking-wide">Total Points</p>
        </div>
        <p class="text-5xl font-bold text-foreground">{{ stats.total_points || 0 }}</p>
        <p class="text-sm text-muted-foreground mt-2">{{ stats.average_points || 0 }} PPG</p>
      </div>

      <!-- Faltas Totales -->
      <div
        class="p-8 bg-card border border-border rounded-lg shadow-card hover:shadow-elevated transition-all"
      >
        <div class="flex items-center gap-3 mb-3">
          <svg
            xmlns="http://www.w3.org/2000/svg"
            class="w-6 h-6 text-destructive"
            fill="none"
            viewBox="0 0 24 24"
            stroke="currentColor"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"
            />
          </svg>
          <p class="text-sm text-muted-foreground uppercase tracking-wide">Total Fouls</p>
        </div>
        <p class="text-5xl font-bold text-foreground">{{ stats.total_fouls || 0 }}</p>
        <p class="text-sm text-muted-foreground mt-2">{{ stats.average_fouls || 0 }}FPG</p>
      </div>
    </div>

    } @else if (stats.isLoading()) {
    <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
      <div
        class="h-[150px] bg-card border border-border rounded-lg shadow-card p-6 mb-8 animate-pulse"
      ></div>
      <div
        class="h-[150px] bg-card border border-border rounded-lg shadow-card p-6 mb-8 animate-pulse"
      ></div>
      <div
        class="h-[150px] bg-card border border-border rounded-lg shadow-card p-6 mb-8 animate-pulse"
      ></div>
    </div>
    } @else if (stats.isError()) {
    <p class="text-xl text-white font-semibold">{{ stats.error() }}</p>
    }

    <!-- Advanced Stats -->
    <div class="bg-card border border-border rounded-lg shadow-card p-8">
      <h2 class="text-3xl font-bold text-foreground mb-6">Last 10 games</h2>
      <app-history-stats [id]="playerId()" />
    </div>
  </main>
</div>
<app-modal [(isOpen)]="isOpen">
  <app-edit-player-modal [player]="player.data()" />
</app-modal>
